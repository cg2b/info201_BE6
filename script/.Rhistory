crime.data <- read.csv("../data/crime.csv")
library("shiny")
library("dplyr")
crime.data <- read.csv("../data/crime.csv")
View(crime.data)
unique(crime.data$Crim.Subcategory)
unique(crime.data$Crime.Subcategory)
library("shiny")
library("dplyr")
crime.data1 <- read.csv("../data/crime.csv")
crime.data1 <- read.csv("../data/crime.csv")
type.data1 <- filter(crime.data1, crime.data, crime.data$Subcategory == "PORNOGRAPHY")
crime.data1 <- read.csv("../data/crime.csv")
type.data1 <- filter(crime.data1, crime.data, crime.data$Crime.Subcategory == "PORNOGRAPHY")
type.data1 <- filter(crime.data1, crime.data$Crime.Subcategory == "PORNOGRAPHY")
View(type.data1)
time.category <- c("morning", "afternoon", "night", "midnight")
count?
>>
?count
morning.freq <- count(type.data1$Occurred.Time >= 800)
morning.freq <- count(type.data1, type.data1$Occurred.Time >= 800)
View(morning.freq)
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800)[1,2]
View(morning.freq)
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800)[[1,2]]
count(type.data1, type.data1$Occurred.Time >= 800)[[2,2]]
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800 & type.data1$Occurred.Time < 1200)[[1,2]]
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800 & type.data1$Occurred.Time < 1200)[[1,2]]
afternoon.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1200 & type.data1$Occurred.Time < 1700)[[1,2]]
night.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]]
midnight.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 0 & type.data1$Occurred.Time < 800)[[1,2]]
18+12+12+12
freq.crime <- c(morning.freq, afternoon.freq, night.freq, midnight.freq)
time.table <- data.frame(time.category, freq.crime)
View(time.table)
barplot(time.table$freq.crime)
barplot(time.table$freq.crime,
horiz = FALSE,
las = 2,
names.args = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
barplot(time.table$freq.crime,
horiz = FALSE,
las = 2,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
barplot(time.table$freq.crime,
horiz = FALSE,
las = 1,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
barplot(time.table$freq.crime,
horiz = FALSE,
las = 1,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
ylab = "frequency of crimes"
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
barplot(time.table$freq.crime,
horiz = FALSE,
las = 1,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
ylab = "frequency of crimes",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
barplot(time.table$freq.crime,
horiz = FALSE,
main = "Frequency of crimes during certain time of a day"
las = 1,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
ylab = "frequency of crimes",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
barplot(time.table$freq.crime,
horiz = FALSE,
main = "Frequency of crimes during certain time of a day",
las = 1,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
ylab = "frequency of crimes",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
runApp()
runApp()
runApp()
runApp()
crime.data1 <- read.csv("../data/crime.csv")
type.data1 <- filter(crime.data1, crime.data$Crime.Subcategory == "GAMBLE")
time.category <- c("morning", "afternoon", "night", "midnight")
# morning: 800~1200, afternoon: 1201~1700, night: 1701~2359, midnight: 0~759
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800 & type.data1$Occurred.Time < 1200)[[1,2]]
afternoon.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1200 & type.data1$Occurred.Time < 1700)[[1,2]]
night.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]]
midnight.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 0 & type.data1$Occurred.Time < 800)[[1,2]]
freq.crime <- c(morning.freq, afternoon.freq, night.freq, midnight.freq)
time.table <- data.frame(time.category, freq.crime)
barplot(time.table$freq.crime,
horiz = FALSE,
main = "Frequency of crimes during certain time of a day",
las = 1,
names.arg = c("morning", "afternoon", "night", "midnight"),
xlab = "Time period of a day",
ylab = "frequency of crimes",
col= c("mistyrose1", "mistyrose2", "mistyrose3", "mistyrose4"))
type.data1 <- filter(crime.data1, crime.data$Crime.Subcategory == "GAMBLE")
crime.data1 <- read.csv("../data/crime.csv")
type.data1 <- filter(crime.data1, crime.data1$Crime.Subcategory == "GAMBLE")
View(type.data1)
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800 & type.data1$Occurred.Time < 1200)[[1,2]]
afternoon.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1200 & type.data1$Occurred.Time < 1700)[[1,2]]
night.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]]
midnight.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 0 & type.data1$Occurred.Time < 800)[[1,2]]
freq.crime <- c(morning.freq, afternoon.freq, night.freq, midnight.freq)
time.table <- data.frame(time.category, freq.crime)
View(time.table)
night.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]
>>
nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]
>
nrow(type.data1)
count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]
>
count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)
count(type.data1, type.data1$Occurred.Time >= 1200 & type.data1$Occurred.Time < 1700)
runApp()
if (type.data1$Crime.Subcategory == "GAMBLE") {
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800 & type.data1$Occurred.Time < 1200)[[1,2]]
afternoon.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1200 & type.data1$Occurred.Time < 1700)[[1,2]]
night.freq <- count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]]
midnight.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 0 & type.data1$Occurred.Time < 800)[[1,2]]
freq.crime <- c(morning.freq, afternoon.freq, night.freq, midnight.freq)
time.table <- data.frame(time.category, freq.crime)
return(time.table)
} else {
morning.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 800 & type.data1$Occurred.Time < 1200)[[1,2]]
afternoon.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1200 & type.data1$Occurred.Time < 1700)[[1,2]]
night.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 1700 & type.data1$Occurred.Time <= 2359)[[1,2]]
midnight.freq <- nrow(type.data1) - count(type.data1, type.data1$Occurred.Time >= 0 & type.data1$Occurred.Time < 800)[[1,2]]
freq.crime <- c(morning.freq, afternoon.freq, night.freq, midnight.freq)
time.table <- data.frame(time.category, freq.crime)
return(time.table)
}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
